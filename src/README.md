## Esquema da aplicaÃ§Ã£o
![Esquema da aplicaÃ§Ã£o](img/20250801225137.png)

## Comandos
- `docker-compose up` para iniciar os containers do Docker (executar no diretÃ³rio em que se encontra o arquivo `docker-compose.yml`)

## Iniciando o Grafana
- UsuÃ¡rio e senha padrÃ£o do Grafana: _admin_
- 1Âº Configurar o data source
    - Prometheus: http://prometheus-forum-api:9090
- 2Âº Criar pasta para dashboards
- 3Âº Criar dashboard (acessar configuraÃ§Ãµes do dashboard para definir tÃ­tulo, descriÃ§Ã£o, tags e etc.)
- 4Âº Criar variÃ¡vel (opcional) em configuraÃ§Ãµes do dashboard
    - Tipo de variÃ¡vel: `query`
    - Nome: `application`
    - Data source: `Prometheus`
    - Tipo de query: `label values`
    - Label: `application` (conforme definido em `management.metrics.tags.application` da aplicaÃ§Ã£o)
    - Preview serÃ¡ gerado automaticamente (`app-forum-api`)
- 5Âº Criar variÃ¡vel (opcional) em configuraÃ§Ãµes do dashboard
    - Tipo de variÃ¡vel: `query`
    - Nome: `instance`
    - Data source: `Prometheus`
    - Tipo de query: `label values`
    - Label: `instance`
    - Metric: `jvm_classes_loaded_classes`
    - Label filters: 
        - `application` = `$application` (variÃ¡vel criada anteriormente)
    - Preview serÃ¡ gerado automaticamente (`app-forum-api:8080`)
- 6Âº Criar variÃ¡vel (opcional) em configuraÃ§Ãµes do dashboard
    - Tipo de variÃ¡vel: `query`
    - Nome: `pool`
    - Data source: `Prometheus`
    - Tipo de query: `label values`
    - Label: `pool`
    - Metric: `hikaricp_connections`
    - Label filters: 
        - `application` = `$application` (variÃ¡vel criada anteriormente)
        - `instance` = `$instance` (variÃ¡vel criada anteriormente)
    - Preview serÃ¡ gerado automaticamente (`HikariPool-1`)
- 7Âº Adicionar nova linha ao dashboard
    - TÃ­tulo: `API BASIC`
- 8Âº Adicionar painel/visualizaÃ§Ã£o
    - Queries
        - Data source: `Prometheus`
        - Metric: `process_uptime_seconds`
        - Label filters:
            - `application` = `$application` (variÃ¡vel criada anteriormente)
            - `instance` = `$instance` (variÃ¡vel criada anteriormente)
            - `job` = `api-forum-api`
    - VisualizaÃ§Ã£o: `EstatÃ­stica (Stat)`
        - OpÃ§Ãµes do painel
            - TÃ­tulo: `UPTIME`
            - DescriÃ§Ã£o: `API uptime`
        - OpÃ§Ãµes de valores
            - CÃ¡lculo: `Ãšltimo nÃ£o nulo`
            - Modo grÃ¡fico: `nenhum`
        - OpÃ§Ãµes padrÃµes
            - Unidade: `Tempo` > `duraÃ§Ã£o (hh:mm:ss)`
        - Limites
            - Apenas item base: ğŸ”µ
- 9Âº Adicionar painel/visualizaÃ§Ã£o
    - Queries
        - Data source: `Prometheus`
        - Metric: `process_start_time_seconds`
        - Label filters:
            - `application` = `$application` (variÃ¡vel criada anteriormente)
            - `instance` = `$instance` (variÃ¡vel criada anteriormente)
            - `job` = `api-forum-api`
        - OperaÃ§Ã£o: `OperaÃ§Ãµes binÃ¡rias` > `Multiplicar por escalar` = 1000
    - VisualizaÃ§Ã£o: `EstatÃ­stica (Stat)`
        - OpÃ§Ãµes do painel
            - TÃ­tulo: `START TIME`
            - DescriÃ§Ã£o: `Hora da inicializaÃ§Ã£o da API`
        - OpÃ§Ãµes de valores
            - CÃ¡lculo: `Ãšltimo nÃ£o nulo`
            - Modo grÃ¡fico: `nenhum`
        - OpÃ§Ãµes padrÃµes
            - Unidade: `Data e hora` > `Data e hora local (Sem data se for hoje)`
        - Limites
            - Apenas item base: ğŸ”µ
- 10Âº Adicionar painel/visualizaÃ§Ã£o
    - Queries
        - Query Warn
            - Data source: `Prometheus`
            - Metric: `logback_events_total`
            - Label filters:
                - `application` = `$application` (variÃ¡vel criada anteriormente)
                - `instance` = `$instance` (variÃ¡vel criada anteriormente)
                - `job` = `api-forum-api`
                - `level` = `warn`
            - OperaÃ§Ã£o: `FunÃ§Ãµes de alcance` > `Aumentar` = 5m
            - OperaÃ§Ã£o: `AgregaÃ§Ã£o` > `Soma` > `RÃ³tulo` = `level`
            - OpÃ§Ãµes
                - Legenda: `Customizada` = `{{level}}`
            - Cor: ğŸŸ¡
        - Query Error
            - Data source: `Prometheus`
            - Metric: `logback_events_total`
            - Label filters:
                - `application` = `$application` (variÃ¡vel criada anteriormente)
                - `instance` = `$instance` (variÃ¡vel criada anteriormente)
                - `job` = `api-forum-api`
                - `level` = `error`
            - OperaÃ§Ã£o: `FunÃ§Ãµes de alcance` > `Aumentar` = 5m
            - OperaÃ§Ã£o: `AgregaÃ§Ã£o` > `Soma` > `RÃ³tulo` = `level`
            - OpÃ§Ãµes
                - Legenda: `Customizada` = `{{level}}`
            - Cor: ğŸ”´
    - VisualizaÃ§Ã£o: `SÃ©rie temporal (Time series)`
        - OpÃ§Ãµes do painel
            - TÃ­tulo: `WARN & ERROR LOG`
            - DescriÃ§Ã£o: `Warnings e erros logados nos Ãºltimos 5 minutos`
        - Legenda
            - Modo: `Tabela`
            - Valores: `Min`, `Max`, `Last *`, `Total`
        - Estilos de grÃ¡fico
            - Opacidade de preenchimento: 10
            - Modo gradiente: `Opacidade`
            - Mostrar pontos: `Nunca`
        - OpÃ§Ãµes padrÃµes
            - Unidade: `Diversos` > `Curto`
            - Decimais: 0
- 11Âº Adicionar painel/visualizaÃ§Ã£o
    - Queries
        - Data source: `Prometheus`
        - Metric: `hikaricp_connections`
        - Label filters:
            - `application` = `$application` (variÃ¡vel criada anteriormente)
            - `instance` = `$instance` (variÃ¡vel criada anteriormente)
            - `job` = `api-forum-api`
        - OperaÃ§Ã£o: `OperaÃ§Ãµes binÃ¡rias` > `Multiplicar por escalar` = 1000
    - VisualizaÃ§Ã£o: `EstatÃ­stica (Stat)`
        - OpÃ§Ãµes do painel
            - TÃ­tulo: `JDBC POOL`
            - DescriÃ§Ã£o: `Pool de conexÃµes JDBC`
        - OpÃ§Ãµes de valores
            - CÃ¡lculo: `Ãšltimo nÃ£o nulo`
        - Estilos de estatÃ­sticas
            - Modo grÃ¡fico: `nenhum`
        - OpÃ§Ãµes padrÃµes
            - Unidade: `Diversos` > `Curto`
        - Limites
            - Base: ğŸ”´
            - Normal: ğŸŸ¢
                - Valor padrÃ£o: 10